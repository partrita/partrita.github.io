<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>scRNA데이터 전처리하기 | Biohacker</title>
<link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/baguetteBox.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/custom.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://partrita.github.io/posts/scRNA-rawdata/">
<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
     tex2jax: {
         inlineMath: [ ['$','$'], ["\\(","\\)"] ],
         displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
         processEscapes: true
     },
     displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
     "HTML-CSS": {
         styles: {'.MathJax_Display': {"margin": 0}}
     }
 });
 </script><!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><link rel="stylesheet" type="text/css" href="../../assets/css/tipuesearch.css">
<link href="https://fonts.googleapis.com/css?family=Noto+Sans" rel="stylesheet">
<meta name="naver-site-verification" content="d38b92eb0fc0075616e5ff8008f707087bfee65e">
<!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NHHK2BF');</script><!-- End Google Tag Manager --><meta name="author" content="Taeyoon Kim">
<link rel="prev" href="../seurat-scRNAseq/" title="Seurat으로 scRNA-seq 데이터 다루기" type="text/html">
<link rel="next" href="../math-4-ML/" title="기계학습을 위한 수학" type="text/html">
<meta property="og:site_name" content="Biohacker">
<meta property="og:title" content="scRNA데이터 전처리하기">
<meta property="og:url" content="https://partrita.github.io/posts/scRNA-rawdata/">
<meta property="og:description" content="시작하기 앞서¶다음과 같은 몇가지 가정을 하고 시작하겠습니다.

가정1. 10x Genomics Single Cell Solution을 통해 얻은 서열 데이터를 사용
가정2. 리눅스(Ubuntu 22.04.3 LTS x86_64) OS를 사용하며 기본적인 shell 명령어를 앎
가정3. 패키지 매니저인 Anaconda에 대한 사용법을 알고 있음

터미널을 ">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2023-09-22T11:57:20+09:00">
<meta property="article:tag" content="10x">
<meta property="article:tag" content="Cell ranger">
<meta property="article:tag" content="Genomics">
<meta property="article:tag" content="Raw data">
<meta property="article:tag" content="Scanpy">
<meta property="article:tag" content="scRNA">
<meta property="article:tag" content="scRNA seq">
<meta property="article:tag" content="Seurat">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../">

            <span id="blog-title">Biohacker</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../pages/about/" class="nav-link">About</a>
                </li>
<li class="nav-item">
<a href="../../pages/resume/index.html" class="nav-link">Resume</a>
                </li>
<li class="nav-item">
<a href="../../pages/books/index.html" class="nav-link">Book</a>
                </li>
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
<span class="navbar-form navbar-right">
<input type="text" id="tipue_search_input" class="form-control" placeholder="Search"></span>

            <ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">scRNA데이터 전처리하기</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Taeyoon Kim
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2023-09-22T11:57:20+09:00" itemprop="datePublished" title="2023-09-22 11:57">2023-09-22 11:57</time></a>
            </p>
            

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div class="cell border-box-sizing text_cell rendered" id="cell-id=a156369d-3781-4a4d-94b5-6416ba74bf0f">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0-%EC%95%9E%EC%84%9C">시작하기 앞서<a class="anchor-link" href="#%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0-%EC%95%9E%EC%84%9C">¶</a>
</h2>
<p>다음과 같은 몇가지 가정을 하고 시작하겠습니다.</p>
<ul>
<li>가정1. 10x Genomics Single Cell Solution을 통해 얻은 서열 데이터를 사용</li>
<li>가정2. 리눅스(Ubuntu 22.04.3 LTS x86_64) OS를 사용하며 기본적인 shell 명령어를 앎</li>
<li>가정3. 패키지 매니저인 Anaconda에 대한 사용법을 알고 있음</li>
</ul>
<p>터미널을 열고 원하는 폴더로 이동합니다. 저는 <code>/home/fkt/Downloads</code>에서 시작하도록 하겠습니다.</p>
<div class="highlight"><pre><span></span><span class="nv">$pwd</span>
/home/fkt/Downloads
</pre></div>
<h2 id="%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD-%EB%A7%8C%EB%93%A4%EA%B8%B0">가상환경 만들기<a class="anchor-link" href="#%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD-%EB%A7%8C%EB%93%A4%EA%B8%B0">¶</a>
</h2>
<p>다음과 같이 사용가상환경을 만들어 사용합니다. 먼저 <code>TutorialEnvironment.yml</code> 파일을 다음 명령어로 다운받습니다.</p>
<blockquote>
<p>해당 파일에는 RNA velocity 분석을 위한 <code>velocyto</code> 도구의 dependancy 정보가 들어 있습니다.</p>
</blockquote>
<div class="highlight"><pre><span></span>wget<span class="w"> </span>https://cf.10xgenomics.com/supp/cell-exp/neutrophils/TutorialEnvironment.yml
</pre></div>
<p>다음 명령어로 가상환경을 만들어 줍니다.</p>
<div class="highlight"><pre><span></span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>--file<span class="w"> </span>TutorialEnvironment.yml
</pre></div>
<p>만들어진 가상환경을 활성화 시킵니다.</p>
<div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>tutorial
</pre></div>
<p>다운로드 받은 <code>yml</code>파일은 삭제해줍니다.</p>
<div class="highlight"><pre><span></span>rm<span class="w"> </span>TutorialEnvironment.yml
</pre></div>
<h2 id="Cell-ranger-%EC%84%A4%EC%B9%98">Cell ranger 설치<a class="anchor-link" href="#Cell-ranger-%EC%84%A4%EC%B9%98">¶</a>
</h2>
<p>10x Genomics Single Cell Solution을 통해 single cell RNA sequncing을 했다면 <code>10x Genomics</code>에서 <code>Cell ranger</code>라는 alignment 도구를 제공하고 있습니다. 속도는 좀 느려도 사용 용이성은 좋아서 저는 <code>Cellranger</code>를 추천합니다. 자세한 것은 <a href="https://www.10xgenomics.com/support/software/cell-ranger">공식사이트</a>를 참고하시기 바랍니다.</p>
<h3 id="%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD">시스템 요구사항<a class="anchor-link" href="#%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD">¶</a>
</h3>
<p><code>Cellranger</code>는 리눅스 시스템에서 작동하며 다음의 최소 사양을 요구합니다:</p>
<ul>
<li>8-core Intel or AMD processor (16 cores recommended).</li>
<li>64GB RAM (128GB recommended).</li>
<li>1TB free disk space.</li>
<li>64-bit CentOS/RedHat 7.0 or Ubuntu 14.04 - See the 10x Genomics OS Support page for details.</li>
</ul>
<p>터미널에 다음 명령어를 입력해 <code>cell ranger 7.2</code>버전을 다운로드 합니다.</p>
<blockquote>
<p>현재 기준으로 7.2 버전이 최신입니다.</p>
</blockquote>
<div class="highlight"><pre><span></span>wget<span class="w"> </span>-O<span class="w"> </span>cellranger-7.2.0.tar.gz<span class="w"> </span><span class="s2">"https://cf.10xgenomics.com/releases/cell-exp/cellranger-7.2.0.tar.gz?Expires=1695129121&amp;Key-Pair-Id=APKAI7S6A5RYOXBWRPDA&amp;Signature=ZipqR8Pg4YvVDQ3MvAVuuiPwEOC5c39~Wj0WTAxfoJW6xtrxqIFgIDySFSFnsWcwDpmAovJGrHXU24Y9Cptt88OJSPdEupyFRXoGKJvVzRtDJChmuMbSpVCy-2N-QnMKwxNtd8Yt8Mdp2Vcq4wxx1hVC0Yx54c7U9o~RFXIVsIp48thKR6JnKhJmCAC5U4dFLa86~NcB4s5Ic4HATrQP2KyWexyYZWgmBEw13mlKYtlVRUil0zseoq0-CZyGmE8oB0iDBSUBAyIqo~XMVjv~lkMz4cRcyCbQKBRDr~U36FM2KnE3rhv-Rlp4KD-uXCReRnBsY6N6t-HxpS2YDpN3mQ__"</span>
</pre></div>
<p>그리고 나서 다음 명령어로 압축을 풀어줍니다.</p>
<div class="highlight"><pre><span></span>tar<span class="w"> </span>-xvf<span class="w"> </span>cellranger-7.2.0.tar.gz
</pre></div>
<p><code>cellranger-7.2.0</code> 폴더로 이동하기</p>
<div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>cellranger-7.2.0
</pre></div>
<p>정상적으로 되었다면 아래와 같은 폴더 구조를 볼 수 있습니다.</p>
<div class="highlight"><pre><span></span>.
├──<span class="w"> </span>bin
├──<span class="w"> </span>builtwith.json
├──<span class="w"> </span>cellranger<span class="w"> </span>-&gt;<span class="w"> </span>bin/cellranger
├──<span class="w"> </span>external
├──<span class="w"> </span>lib
├──<span class="w"> </span>LICENSE
├──<span class="w"> </span>mro
├──<span class="w"> </span>probe_sets<span class="w"> </span>-&gt;<span class="w"> </span>external/tenx_feature_references/targeted_panels
├──<span class="w"> </span>sourceme.bash
├──<span class="w"> </span>sourceme.csh
└──<span class="w"> </span>THIRD-PARTY-LICENSES.cellranger.txt

<span class="m">5</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">6</span><span class="w"> </span>files
</pre></div>
<p>이제 <code>./cellranger</code>명령어를 입력하면 아래와 같이 cell ranger 실행이 가능합니다.</p>
<div class="highlight"><pre><span></span>./cellranger
cellranger<span class="w"> </span>cellranger-7.2.0

Process<span class="w"> </span>10x<span class="w"> </span>Genomics<span class="w"> </span>Gene<span class="w"> </span>Expression,<span class="w"> </span>Feature<span class="w"> </span>Barcode,<span class="w"> </span>and<span class="w"> </span>Immune<span class="w"> </span>Profiling<span class="w"> </span>data

Usage:<span class="w"> </span>cellranger<span class="w"> </span>&lt;COMMAND&gt;

Commands:
<span class="w">  </span>count<span class="w">           </span>Count<span class="w"> </span>gene<span class="w"> </span>expression<span class="w"> </span>and/or<span class="w"> </span>feature<span class="w"> </span>barcode<span class="w"> </span>reads<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>single<span class="w"> </span>sample<span class="w"> </span>and<span class="w"> </span>GEM<span class="w"> </span>well
<span class="o">(</span>중략<span class="o">)</span>
<span class="w">  </span><span class="nb">help</span><span class="w">            </span>Print<span class="w"> </span>this<span class="w"> </span>message<span class="w"> </span>or<span class="w"> </span>the<span class="w"> </span><span class="nb">help</span><span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>given<span class="w"> </span>subcommand<span class="o">(</span>s<span class="o">)</span>

Options:
<span class="w">  </span>-h,<span class="w"> </span>--help<span class="w">     </span>Print<span class="w"> </span><span class="nb">help</span>
<span class="w">  </span>-V,<span class="w"> </span>--version<span class="w">  </span>Print<span class="w"> </span>version
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" id="cell-id=5eca5895-081b-487e-8a4d-f8d19efc62d6">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="FASTQ-%ED%8C%8C%EC%9D%BC%EA%B3%BC-%EB%A0%88%ED%8D%BC%EB%9F%B0%EC%8A%A4-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A4%80%EB%B9%84">FASTQ 파일과 레퍼런스 데이터 준비<a class="anchor-link" href="#FASTQ-%ED%8C%8C%EC%9D%BC%EA%B3%BC-%EB%A0%88%ED%8D%BC%EB%9F%B0%EC%8A%A4-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A4%80%EB%B9%84">¶</a>
</h2>
<p>10x Genomics사에서는 학습을 위한 데이터를 제공하고 있습니다. 이미 많은 예제에서 <code>Human 1k PBMC</code>를 다루고 있으므로 저는 <code>Mouse 1k neuron</code>으로 진행해보겠습니다. <code>Human 1k PBMC</code>은 직접해보시기 바랍니다.</p>
<h3 id="Human-PBMC-1k-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C">Human PBMC 1k 데이터 다운로드<a class="anchor-link" href="#Human-PBMC-1k-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C">¶</a>
</h3>
<p>터미널에 다음과 같이 입력합니다.</p>
<div class="highlight"><pre><span></span>mkdir<span class="w"> </span>data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>data
<span class="c1">#  Human PBMC 1k = 5.17GB</span>
wget<span class="w"> </span>https://cf.10xgenomics.com/samples/cell-exp/3.0.0/pbmc_1k_v3/pbmc_1k_v3_fastqs.tar
tar<span class="w"> </span>-xvf<span class="w"> </span>pbmc_1k_v3_fastqs.tar
<span class="c1"># Human reference (GRCh38) = 11GB</span>
wget<span class="w"> </span>https://cf.10xgenomics.com/supp/cell-exp/refdata-gex-GRCh38-2020-A.tar.gz
tar<span class="w"> </span>-zxvf<span class="w"> </span>refdata-gex-GRCh38-2020-A.tar.gz
</pre></div>
<h3 id="Mouse-1k-neuron-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C">Mouse 1k neuron 데이터 다운로드<a class="anchor-link" href="#Mouse-1k-neuron-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C">¶</a>
</h3>
<p>터미널에 다음과 같이 입력합니다.</p>
<div class="highlight"><pre><span></span><span class="c1"># Mouse neron 1k data = 7GB</span>
wget<span class="w"> </span>http://cf.10xgenomics.com/samples/cell-exp/3.0.0/neuron_1k_v3/neuron_1k_v3_fastqs.tar
tar<span class="w"> </span>-xvf<span class="w"> </span>neuron_1k_v3_fastqs.tar
<span class="c1"># Mouse reference = 9.7GB</span>
wget<span class="w"> </span>https://cf.10xgenomics.com/supp/cell-exp/refdata-gex-mm10-2020-A.tar.gz
tar<span class="w"> </span>-zxvf<span class="w"> </span>refdata-gex-mm10-2020-A.tar.gz
</pre></div>
<h3 id="%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C%EB%90%9C-%ED%8C%8C%EC%9D%BC-%ED%99%95%EC%9D%B8">다운로드된 파일 확인<a class="anchor-link" href="#%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C%EB%90%9C-%ED%8C%8C%EC%9D%BC-%ED%99%95%EC%9D%B8">¶</a>
</h3>
<p>정상적으로 진행되었다면 아래와 같은 폴더와 52개의 파일을 확인할 수 있습니다.</p>
<div class="highlight"><pre><span></span>$<span class="w"> </span>tree<span class="w"> </span>.
.
├──<span class="w"> </span>neuron_1k_v3_fastqs
│<span class="w">   </span>├──<span class="w"> </span>neuron_1k_v3_S1_L001_I1_001.fastq.gz
│<span class="w">   </span>├──<span class="w"> </span>neuron_1k_v3_S1_L001_R1_001.fastq.gz
│<span class="w">   </span>├──<span class="w"> </span>neuron_1k_v3_S1_L001_R2_001.fastq.gz
│<span class="w">   </span>├──<span class="w"> </span>neuron_1k_v3_S1_L002_I1_001.fastq.gz
│<span class="w">   </span>├──<span class="w"> </span>neuron_1k_v3_S1_L002_R1_001.fastq.gz
│<span class="w">   </span>└──<span class="w"> </span>neuron_1k_v3_S1_L002_R2_001.fastq.gz
├──<span class="w"> </span>pbmc_1k_v3_fastqs
│<span class="w">   </span>├──<span class="w"> </span>pbmc_1k_v3_S1_L001_I1_001.fastq.gz
│<span class="w">   </span>├──<span class="w"> </span>pbmc_1k_v3_S1_L001_R1_001.fastq.gz
│<span class="w">   </span>├──<span class="w"> </span>pbmc_1k_v3_S1_L001_R2_001.fastq.gz
│<span class="w">   </span>├──<span class="w"> </span>pbmc_1k_v3_S1_L002_I1_001.fastq.gz
│<span class="w">   </span>├──<span class="w"> </span>pbmc_1k_v3_S1_L002_R1_001.fastq.gz
│<span class="w">   </span>└──<span class="w"> </span>pbmc_1k_v3_S1_L002_R2_001.fastq.gz
├──<span class="w"> </span>refdata-gex-GRCh38-2020-A
│<span class="w">   </span>├──<span class="w"> </span>fasta
│<span class="w">   </span>├──<span class="w"> </span>genes
│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>genes.gtf
│<span class="w">   </span>├──<span class="w"> </span>pickle
│<span class="w">   </span>├──<span class="w"> </span>reference.json
│<span class="w">   </span>└──<span class="w"> </span>star
└──<span class="w"> </span>refdata-gex-mm10-2020-A
<span class="w">    </span>├──<span class="w"> </span>fasta
<span class="w">    </span>├──<span class="w"> </span>genes
<span class="w">    </span>│<span class="w">   </span>└──<span class="w"> </span>genes.gtf
<span class="w">    </span>├──<span class="w"> </span>pickle
<span class="w">    </span>├──<span class="w"> </span>reference.json
<span class="w">    </span>└──<span class="w"> </span>star

<span class="m">12</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">52</span><span class="w"> </span>files
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" id="cell-id=1577bf9d-295e-4c77-a433-33bc3f9d21c2">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cell-ranger-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0">Cell ranger 사용하기<a class="anchor-link" href="#Cell-ranger-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0">¶</a>
</h2>
<p>데이터가 준비되었으니 <code>Cell ranger</code>를 사용해 <code>count matrix</code>를 만들어 보겠습니다.
먼저 상위 디렉토리인 <code>cellranger-7.2.0</code>으로 이동합니다.</p>
<div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>..
</pre></div>
<p>다음과 같이 <code>cellranger count</code> 명령어를 사용하면 <code>count matrix</code>데이터를 얻을 수 있습니다.</p>
<div class="highlight"><pre><span></span>./cellranger<span class="w"> </span>count<span class="w"> </span>--id<span class="o">=</span>run_count_mNeuron1k<span class="w"> </span><span class="se">\</span>
--fastqs<span class="o">=</span>data/neuron_1k_v3_fastqs<span class="w">  </span><span class="se">\</span>
--sample<span class="o">=</span>neuron_1k_v3<span class="w">  </span><span class="se">\</span>
--transcriptome<span class="o">=</span>data/refdata-gex-mm10-2020-A
</pre></div>
<p><code>--id</code>는 생성되는 폴더명이며 <code>--fastqs</code>는 다운로드한 <code>fastq</code>파일의 위치입니다.
<code>--sample</code>은 fastq 파일명의 접두사(prefix)를 의미하고 <code>--transcriptome</code>은 레퍼런스데이터의 위치입니다.</p>
<p>시간이 좀 지나면 다음과 같은 출력을 볼 수 있습니다.</p>
<div class="highlight"><pre><span></span>Running<span class="w"> </span>preflight<span class="w"> </span>checks<span class="w"> </span><span class="o">(</span>please<span class="w"> </span><span class="nb">wait</span><span class="o">)</span>...
Checking<span class="w"> </span>sample<span class="w"> </span>info...
Checking<span class="w"> </span>FASTQ<span class="w"> </span>folder...
Checking<span class="w"> </span>reference...
<span class="o">(</span>후략<span class="o">)</span>
</pre></div>
<p>정상적으로 작업이 완료된다면 아래처럼 <code>outs</code>이라는 폴더가 생성됩니다. 여기에는 <code>count matrix</code>뿐만 아니라 여러가지 분석 결과도 포함되어 있어 복잡해보입니다. 그러나 저희가 필요 한 것은 <code>filtered_feature_bc_matrix</code> 폴더 안에 다들어 있습니다.</p>
<div class="highlight"><pre><span></span>outs
├──<span class="w"> </span>analysis
├──<span class="w"> </span>cloupe.cloupe
├──<span class="w"> </span>filtered_feature_bc_matrix
├──<span class="w"> </span>filtered_feature_bc_matrix.h5
├──<span class="w"> </span>metrics_summary.csv
├──<span class="w"> </span>molecule_info.h5
├──<span class="w"> </span>possorted_genome_bam.bam
├──<span class="w"> </span>possorted_genome_bam.bam.bai
├──<span class="w"> </span>raw_feature_bc_matrix
├──<span class="w"> </span>raw_feature_bc_matrix.h5
└──<span class="w"> </span>web_summary.html
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" id="cell-id=5b336a12-9291-45dd-8ae0-3b7f2f4df52b">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="RNA-velocity-%EB%B6%84%EC%84%9D%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%9E%91%EC%97%85">RNA velocity 분석을 위한 작업<a class="anchor-link" href="#RNA-velocity-%EB%B6%84%EC%84%9D%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%9E%91%EC%97%85">¶</a>
</h2>
<p>RNA velocity이란? 스플라이싱된 RNA와 아직 스플라이싱되지 않은 RNA를 구분해 세포의 상태를 예측하는 기법으로 scRNA 데이터에서 클러스터간에 분화 과정에 대한 단서를 얻을 수 있습니다. 예를 들어 아래 그림에서 보면 cluster4에서 cluster2로의 방향성을 확인 할 수 있습니다.</p>
<p><img alt="" src="https://cdn.10xgenomics.com/image/upload/c_scale,w_600/v1646345944/analysis-guides/velocity-tutorial/scVelo-umap-cluster.png"></p>
<p>안타깝게도 <code>Cell ranger</code>를 통해 얻은 <code>count matrix</code>로는 RNA velocity 분석을 할 수 없습니다. 추가적으로 <code>velocyto</code>이라는 도구를 사용해 unspliced , spliced 데이터가 포함된 <code>loom</code>파일을 만들어야 합니다. 아래 명령어를 사용하면 간단하게 얻을 수 있습니다.</p>
<div class="highlight"><pre><span></span>velocyto<span class="w"> </span>run10x<span class="w"> </span>run_count_mNeuron1k/<span class="w"> </span>data/refdata-gex-mm10-2020-A/genes/genes.gtf
</pre></div>
<p>실행이 완료되는 시간은 생각보다 오래 걸립니다.</p>
<div class="highlight"><pre><span></span><span class="m">2023</span>-09-19<span class="w"> </span><span class="m">10</span>:01:22,756<span class="w"> </span>-<span class="w"> </span>DEBUG<span class="w"> </span>-<span class="w"> </span>Using<span class="w"> </span>logic:<span class="w"> </span>Default
<span class="m">2023</span>-09-19<span class="w"> </span><span class="m">10</span>:01:22,757<span class="w"> </span>-<span class="w"> </span>DEBUG<span class="w"> </span>-<span class="w"> </span>Example<span class="w"> </span>of<span class="w"> </span>barcode:<span class="w"> </span>AAACGAATCAAAGCCT<span class="w"> </span>and<span class="w"> </span>cell_id:<span class="w"> </span>run_count_mNeuron1k:AAACGAATCAAAGCCT-1
<span class="o">(</span>중략<span class="o">)</span>
<span class="m">2023</span>-09-19<span class="w"> </span><span class="m">10</span>:27:23,985<span class="w"> </span>-<span class="w"> </span>DEBUG<span class="w"> </span>-<span class="w"> </span><span class="m">1991314</span><span class="w"> </span>reads<span class="w"> </span>were<span class="w"> </span>skipped<span class="w"> </span>because<span class="w"> </span>no<span class="w"> </span>apropiate<span class="w"> </span>cell<span class="w"> </span>or<span class="w"> </span>umi<span class="w"> </span>barcode<span class="w"> </span>was<span class="w"> </span>found
<span class="m">2023</span>-09-19<span class="w"> </span><span class="m">10</span>:27:23,985<span class="w"> </span>-<span class="w"> </span>DEBUG<span class="w"> </span>-<span class="w"> </span>Counting<span class="w"> </span><span class="k">done</span>!
<span class="m">2023</span>-09-19<span class="w"> </span><span class="m">10</span>:27:23,988<span class="w"> </span>-<span class="w"> </span>DEBUG<span class="w"> </span>-<span class="w"> </span>Collecting<span class="w"> </span>row<span class="w"> </span>attributes
<span class="m">2023</span>-09-19<span class="w"> </span><span class="m">10</span>:27:24,014<span class="w"> </span>-<span class="w"> </span>DEBUG<span class="w"> </span>-<span class="w"> </span>Generating<span class="w"> </span>data<span class="w"> </span>table
<span class="m">2023</span>-09-19<span class="w"> </span><span class="m">10</span>:27:24,056<span class="w"> </span>-<span class="w"> </span>DEBUG<span class="w"> </span>-<span class="w"> </span>Writing<span class="w"> </span>loom<span class="w"> </span>file
<span class="m">2023</span>-09-19<span class="w"> </span><span class="m">10</span>:27:25,286<span class="w"> </span>-<span class="w"> </span>DEBUG<span class="w"> </span>-<span class="w"> </span>Terminated<span class="w"> </span>Succesfully!
</pre></div>
<p>완료가 되면 <code>run_count_mNeuron1k</code>폴더안에 <code>velocyto</code>라는 새로운 폴더가 생기고 <code>run_count_mNeuron1k.loom</code> 파일이 생성됩니다.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" id="cell-id=631401f0-e088-4ab6-8ca9-98c5de9435d4">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Count-matrix-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9D%BD%EA%B8%B0">Count matrix 데이터 읽기<a class="anchor-link" href="#Count-matrix-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9D%BD%EA%B8%B0">¶</a>
</h2>
<p>이제 힘든 데이터 준비 과정이 모두 끝났습니다. 데이터 분석을 시작해보죠. scRNA-seq 분야는 아직 초기이고 새로운 도구들이 계속 쏟아지고 있습니다. 나중은 어떻게 될지 모르겠지만 지금 시점에서는 <code>R</code>에 익숙하다면 <code>Seurat</code>, <code>Python</code>에 익숙하다면 <code>Scanpy</code>를 추천합니다.</p>
<blockquote>
<p>참고로 속도적인 측면과 ML을 접목하기에는 Scanpy가 더 강점을 가지고 있습니다.</p>
</blockquote>
<h3 id="Scanpy-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0">Scanpy 사용하기<a class="anchor-link" href="#Scanpy-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0">¶</a>
</h3>
<p>다음 코드를 통해 count matrix를 scanpy로 불러 올 수 있습니다.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=1e83ee5a-1b68-4e1b-915e-a29168d38d21">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># conda install pandas scanpy</span>
<span class="kn">import</span> <span class="nn">scanpy</span> <span class="k">as</span> <span class="nn">sc</span>

<span class="c1"># Cell ranger 결과 파일이 들어있는 경로</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s2">"../input/run_count_mNeuron1k/outs/filtered_feature_bc_matrix"</span>

<span class="c1"># read_10x_mtx 함수를 사용</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read_10x_mtx</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="s2">"gene_symbols"</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">adata</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[1]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>AnnData object with n_obs × n_vars = 1311 × 32285
    var: 'gene_ids', 'feature_types'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" id="cell-id=ea6c40ad">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>scVelo를 사용해 RNA velocity분석을 한다면 아래의 추가적인 코드가 필요합니다.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=1868db07-40b2-4213-b062-f88b1fe0d693">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># conda install -c bioconda scvelo</span>
<span class="kn">import</span> <span class="nn">scvelo</span> <span class="k">as</span> <span class="nn">scv</span>

<span class="c1"># load loom files for spliced/unspliced matrices for each sample</span>
<span class="n">loom</span> <span class="o">=</span> <span class="n">scv</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">/run_count_mNeuron1k.loom"</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># rename barcodes in order to merge:</span>
<span class="n">barcodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">bc</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">":"</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">bc</span> <span class="ow">in</span> <span class="n">loom</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
<span class="n">barcodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">bc</span><span class="p">[</span><span class="mi">0</span> <span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">bc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"-1"</span> <span class="k">for</span> <span class="n">bc</span> <span class="ow">in</span> <span class="n">barcodes</span><span class="p">]</span>
<span class="n">loom</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">barcodes</span>

<span class="c1"># make variable names unique</span>
<span class="n">loom</span><span class="o">.</span><span class="n">var_names_make_unique</span><span class="p">()</span>

<span class="c1"># merge matrices into the original adata object</span>
<span class="n">adata</span> <span class="o">=</span> <span class="n">scv</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">loom</span><span class="p">)</span>
<span class="n">adata</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[2]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>AnnData object with n_obs × n_vars = 1311 × 32285
    obs: 'initial_size_unspliced', 'initial_size_spliced', 'initial_size'
    var: 'gene_ids', 'feature_types', 'Accession', 'Chromosome', 'End', 'Start', 'Strand'
    layers: 'matrix', 'ambiguous', 'spliced', 'unspliced'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=4ffd23b8-a12a-4920-9c5d-537386cda97a">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">scv</span><span class="o">.</span><span class="n">pl</span><span class="o">.</span><span class="n">proportions</span><span class="p">(</span><span class="n">adata</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img alt="No description has been provided for this image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANMAAADGCAYAAABIHLXxAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8pXeV/AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAjeUlEQVR4nO2deXQc1Z2ov+rqXVJrbW2WbMkyXiRbi20Z7xgMJmAgBsySPJZwWCZhhiHvMWHy5pGcmXNg8piQR8hwMhOYmDwnQAi7YXgmGOLBgG0277K1r9aultQtqfeq94eQYgjgtlS93+8cHVtS9a1fterre+suvyupqqoiEAhmjS7aAQgEiYKQSSDQCCGTQKARQiaBQCOETAKBRgiZBAKNEDIJBBohZBIINEKvRSHBYBC/369FUQJBTGEwGJBlOaRjZy3T2NgYXV1diIkUgkREkiSKiopITU09+7GzmU4UDAZpbGzEarVit9uRJGmmRQkEMYeqqgwMDDAxMcF555131hpqVjWT3+9HVVXsdjsWi2U2RQkEMYndbqetrQ2/339WmTTpgBA1kiBROZd7W5MOiDP5m3sPa10kAI8/Vh2Wcvfu3cv3v/99Dh8+THd3NzfccAP79u3TrPycnBw+/vhjSkpKNCvzTF66fGtYygW45o3/DFvZM0WSJIaHh8nIyODyyy/n0UcfZdGiRZqUvX37dq644gq+853vzOj1mssUzxQWFmoqkiC8vPHGG9EO4XMk3DiT2+3mhhtuoLy8nKqqKrZs2cLevXtZunQpt9xyC0uXLmXFihUcPnz4L17b1tZGRkbG9Pf79+9n/fr1VFVVUVlZyauvvgpAY2MjW7dupba2lsrKSh5//PHp1+zatYslS5ZQWVnJ/fffH+7LjQkkSWJkZGT6+5ycHNra2gAoKSnhxz/+MWvWrKG0tJQHH3xw+rgHH3yQJUuWUF1dTXV1Ne3t7dPlPfDAA9TU1LBw4UKefvrpLz1vSUnJ9N/x9OnTbN++nWXLllFZWcmPfvQjAFwuF3feeSerVq2isrKSu+66C5/PB8CpU6dYu3YtFRUVbNu2DafTOav3IeFqpt27dzMyMkJdXR0ADoeDo0ePcuLECR577DF27tzJH/7wB2688UZOnjz5leU4HA62bdvGCy+8wIYNG1AUhZGREYLBIN/61rf43e9+x+LFi5mYmGD16tWcf/75zJs3j9tuu419+/ZRXl7OE088wdDQUKQuPWYZGRlh//79DA4OUlZWxm233YbVauWRRx6hp6cHi8XCxMQEOt2fP9slSeLQoUO0tLSwcuVK1q1b97VN5ZtuuoktW7bwwgsvADAwMADAfffdx4YNG3jyySdRVZU777yTxx57jB/84AfcfPPNfPe73+X222/n2LFjrFy5km9/+9szvs6Eq5mqqqo4efIkd999N8899xwGgwGY/BTbvHkzANdffz29vb10dnZ+ZTn79+9n0aJFbNiwAQCdTkdWVhb19fWcOHGCG2+8kerqatauXYvL5aKuro4DBw5QWVlJeXk5ALfffjtGozHMVxz7TN2gOTk5zJ8/n9bWVmw2G+eddx433XQTv/rVr3A4HJjN5unX3HHHHQDMnz+fjRs38u67735l+WNjY7z33nvcd9990z+z2+0AvPLKK/z0pz+lurqampoa9u3bR1NTE06nk8OHD08/Hy1btoz169fP6joTrmaaP38+dXV1vPPOO+zZs4f777+fn//8539xnCRJM+qFVFWVrKysL20m7tq16y/OkQzIskwwGJz+3uPxfO73Z0oiyzKBQABZljlw4AAffPABe/fuZfXq1Tz77LPTH15fZKbvpaqqvPjiiyxcuPBzP/+yJt1s/14JVzN1dXUhSRJXXXUVjzzyCKqq0tnZSVtbG3/6058AeOGFF8jLy6OoqOgry1m7di2NjY3THRKKouBwOFi0aBE2m42nnnpq+timpiYcDgdr1qzh6NGjnDp1CoAdO3ZMt88TmQULFnDw4EEAXnrpJcbHx8/6GpfLRV9fHxs2bOBHP/oR69ev59ChQ9O/n3p/29ra2Ldv31dKBpCamsrGjRv52c9+Nv2zqWbetm3bePjhhwkEAgAMDw/T1NSEzWajpqaGnTt3AnDixAnee++9c7zyz5NwMh07dox169ZRVVVFTU0NN998M5WVlVRUVPCb3/yGZcuW8ZOf/IRnn332az+JMjMzefnll/nhD39IZWUly5cv5/3330ev1/P666/z0ksvTZd7++2343a7sdvt7Nixg6uvvpqqqioaGxvJzs6O4NVHh0cffZR7772X5cuXc+jQoZCueXR0lGuuuWa6w8Dv93PrrbdO/z4YDFJTU8OWLVv4xS9+cdahhd/+9rd8/PHHVFRUUF1dPd0p9Oijj2KxWKiu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">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" id="cell-id=07d220cf">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>scanpy는 <code>*.h5ad</code> 포멧을 사용해 <code>count matrix</code>를 저장합니다. 아래 코드를 사용하면 단일 파일로 모든 것을 저장할 수 있습니다.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=14b6ea54-2dbd-4180-95cf-a4c16038a9c4">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">adata</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"../output/mNeuron1k.h5ad"</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">"gzip"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" id="cell-id=0acb9d43-c2cf-4ddb-9bab-2479d1b8cf54">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Seurat-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0">Seurat 사용하기<a class="anchor-link" href="#Seurat-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0">¶</a>
</h3>
<p><code>R</code>에 좀 더 익숙하시다면 <code>Seurat</code>을 사용하세요. 저는 파이썬 문법을 더 좋아하지만 솔직히 분석 도구의 완성도 측면에서는 <code>Seurat</code>이 더 나은 것 같습니다. 아래 코드는 <code>jupyter notebook</code>에서 <code>R</code>코드를 사용하기 위해 필요한 것으로 <code>rStudio</code>를 사용하신다면 <code>%%R</code>이 포함된 셀의 코드만 사용하시면 됩니다.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=fd9293cd-66d8-4aab-9a91-581156580ebb">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">rpy2.rinterface_lib.callbacks</span> <span class="k">as</span> <span class="nn">rcb</span>

<span class="c1"># import rpy2.robjects as ro</span>

<span class="n">rcb</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>
<span class="o">%</span><span class="k">load_ext</span> rpy2.ipython
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" id="cell-id=26135b5f">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>필요한 <code>Seurat</code> 라이브러리를 불러옵니다.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=c9b851da-9d12-465a-94b3-cb3979c9255e">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">Seurat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>
    WARNING: The R package "reticulate" only fixed recently
    an issue that caused a segfault when used with rpy2:
    https://github.com/rstudio/reticulate/pull/1188
    Make sure that you use a version of that package that includes
    the fix.
    </pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" id="cell-id=ad9076d5">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>아래의 코드를 사용하면 <code>count matrix</code>를 <code>Seurat object</code>로 만들 수 있습니다.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=03a5512a-eef5-4b89-969d-0715287d90de">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span>
<span class="c1"># Load dataset</span>
<span class="n">neuron.data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Read10X</span><span class="p">(</span><span class="n">data.dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"../input/run_count_mNeuron1k/outs/filtered_feature_bc_matrix"</span><span class="p">)</span>
<span class="c1"># Initialize the Seurat object.</span>
<span class="n">obj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">CreateSeuratObject</span><span class="p">(</span><span class="n">counts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">neuron.data</span><span class="p">)</span>
<span class="n">obj</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>An object of class Seurat 
32285 features across 1311 samples within 1 assay 
Active assay: RNA (32285 features, 0 variable features)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" id="cell-id=8ab1d699">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>Seurat object</code>를 파일로 저장하는 방법에도 여러가지가 있지만 <code>R</code>에서 많이 사용되는 <code>*.rds</code>를 사용하는 코드는 아래와 같습니다.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=2a3178bf-3aff-4ee4-a2a8-d7b36eefa45a">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="n">R</span>
<span class="nf">saveRDS</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"../output/mNeuron1k.rds"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" id="cell-id=1bc9da6c-c996-41df-98c9-965eddd39e6a">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="%EB%A7%88%EC%B9%98%EB%A9%B0">마치며<a class="anchor-link" href="#%EB%A7%88%EC%B9%98%EB%A9%B0">¶</a>
</h2>
<p>이것으로 scRNA seq 데이터의 전처리 과정을 알아봤습니다. 여기 적힌 방법 외에도 더 효율적이고 나은 방법도 있고 앞으로도 더 생겨날 것입니다. 그러나 저도 배우는 입장에서 다른 분들에게 도움이 되고자 정리를 해봤습니다. 실제 실험을 통해 얻은 데이터를 분석하는데 도움이 되길 바랍니다.</p>
</div>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/10x/" rel="tag">10x</a></li>
            <li><a class="tag p-category" href="../../categories/cell-ranger/" rel="tag">Cell ranger</a></li>
            <li><a class="tag p-category" href="../../categories/genomics/" rel="tag">Genomics</a></li>
            <li><a class="tag p-category" href="../../categories/raw-data/" rel="tag">Raw data</a></li>
            <li><a class="tag p-category" href="../../categories/scanpy/" rel="tag">Scanpy</a></li>
            <li><a class="tag p-category" href="../../categories/scrna/" rel="tag">scRNA</a></li>
            <li><a class="tag p-category" href="../../categories/scrna-seq/" rel="tag">scRNA seq</a></li>
            <li><a class="tag p-category" href="../../categories/seurat/" rel="tag">Seurat</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../seurat-scRNAseq/" rel="prev" title="Seurat으로 scRNA-seq 데이터 다루기">Previous post</a>
            </li>
            <li class="next">
                <a href="../math-4-ML/" rel="next" title="기계학습을 위한 수학">Next post</a>
            </li>
        </ul></nav></aside><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
 MathJax.Hub.Config({
     tex2jax: {
         inlineMath: [ ['$','$'], ["\\(","\\)"] ],
         displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
         processEscapes: true
     },
     displayAlign: 'center', // Change this to 'left' if you want left-aligned equations.
     "HTML-CSS": {
         styles: {'.MathJax_Display': {"margin": 0}}
     }
 });
 </script></article><!--End of body content--><footer id="footer">
            Contents © 2023         <a href="mailto:partrita@gmail.com">Taeyoon Kim</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


            <script src="../../assets/js/jquery.min.js"></script><script src="../../assets/js/popper.min.js"></script><script src="../../assets/js/bootstrap.min.js"></script><script src="../../assets/js/baguetteBox.min.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script><!-- Modal --><div id="search-results" class="modal fade" role="dialog" style="height: 80%;">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h4 class="modal-title">Search Results:</h4>
      </div>
      <div class="modal-body" id="tipue_search_content" style="max-height: 600px; overflow-y: auto;">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<script>
var siteUrl = "https://partrita.github.io/"
$(document).ready(function() {
    $.when(
        $.getScript( siteUrl + "/assets/js/tipuesearch_set.js" ),
        $.getScript( siteUrl + "/assets/js/tipuesearch.js" ),
        $.Deferred(function( deferred ){
            $( deferred.resolve );
        })
    ).done(function() {
        $('#tipue_search_input').tipuesearch({
            'mode': 'json',
            'contentLocation': siteUrl + '/assets/js/tipuesearch_content.json'
        });
        $('#tipue_search_input').keyup(function (e) {
            if (e.keyCode == 13) {
                $('#search-results').modal()
            }
        });
    });
});
</script><!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NHHK2BF" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


</body>
</html>
